\chapter{Flow Control}
In this chapter, implementation and evaluation of various control algorithms for flow control purposes will be presented. At first, the aim is to enable regulation of flow to a constant value. Later on, the system's ability to follow different reference flow trajectories will be tested. In a final step, the system will be subjected to disturbances through the HiL test rig in form of heart beats at different heart rates. Performances of the implemented control algorithms will be compared.
% As a first step towards flow control implementation two versions of PI controllers are implemented to ensure stable system behavior. After comparing the performance results of both approaches, a parallel approach to ILC implementation under use of the higher performing PI controller is applied to improve the follow up behavior and reduce control errors.
\section{PI Controller}
PI control implementation is performed on the basis of the tuning rules according to Ziegler Nichols as well as according to Chien Hrones Reswick (Chapter \ref{chap:CHR}). The performance of both controllers later on is  compared and evaluated.
\subsection{Design and Implementation}
As a preparation for utilization of the inflection tangent method for these tuning approaches, a measurement similar to the one for determining the static map is performed. \figurename~\ref{fig:dyn_meas} depicts the signal curves for determination of the tuning parameters.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/dyn_measure.pdf}
  \caption[Signal curves for determination of PI controller parameters]{Signal curves for determination of PI controller parameters. Top: differential pressure as reference and measured signal, middle: reference and measured rotational speed, bottom: measured flow through Sputnik VAD.}
  \label{fig:dyn_meas}
\end{figure}
As presented in the upper graph, differential pressure is increased in steps of $20\,mmHg$ from $\Delta{p}=0\,mmHg$ to $\Delta{p}=100\,mmHg$. For each level the sequence of reference velocities depicted exemplary for $\Delta{p}=40\,mmHg$ in the center graph of \figurename~\ref{fig:dyn_meas_40} is targeted. Starting at $v_{ref}=4000 \, rpm $ the velocity is first increased in three steps of varying height and then decreased by the same values. The first step amounts to $200 \, rpm$, the second to $400\,rpm$ and the third to $600 \, rpm$. The reference value is then increased by $1000\,rpm$ and again the three steps are executed. This sequential behavior is repeated up to a start value of $v_{ref}=8000\,rpm$.
\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/dyn_meas_40.pdf}
  \caption[Signal curves for determination of PI controller parameters at $\Delta{p}=40\,mmHg$]{Signal curves for determination of PI controller parameters at $\Delta{p}=40\,mmHg$.}
  \label{fig:dyn_meas_40}
\end{figure}
For determination of the parameters for controller design the step from $v_{ref,low}=5000\, rpm$ to $v_{ref,high}=5400\, rpm$ at $\Delta{p}=40\,mmHg$, which is located in the center of the pump's operating range, is used.
Since the flow signal is affected by high measurement noise, the signal is preprocessed using an $8^{th}$-order butterworth filter with cut off frequency $f_c=5\,Hz$ and sampling frequency $f_s=1000\,Hz$.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/param_calc_PI.pdf}
  \caption[Step response for determination of PI controller tuning parameters]{Step response for a step in rotational speed of $400\,rpm$ for determination of PI controller tuning parameters.}
  \label{fig:param_calc_PI}
\end{figure}
The resulting signal and the characteristic parameters needed for parameter tuning of the PI controller are depicted in \figurename~\ref{fig:param_calc_PI}. With $k_{high}=2.8149$ and $k_{low}=1.7783$ the static gain is determined as in equation (\ref{eq:k_s_1}) to
\begin{equation}
  k_s = \frac{k_{high}-k_{low}}{v_{ref,high}-v_{ref,low}}= 0.0026.
\label{eq:k_s_2}
\end{equation}
The time constants amount to $T_g=0.193$ and $T_v=0.1$.
\\For determination of a PI controller tuned according to Ziegler Nichols equations (\ref{eq:kp_zn}) to (\ref{eq:T_N_zn}) are used. By this $K_{P}$ is determined as
\begin{equation}
  K_{P} = 0.9\cdot\frac{0.193}{0.0026\cdot0.1}=670.3052
\end{equation}
and $K_I$ as
\begin{equation}
  K_{I}  = \frac{670.3052}{3.3\cdot0.1}=2031.2278.
\end{equation}
Substituting these values in equation (\ref{eq:pi_contr_2}) results in the transfer function
\begin{equation}
  G_{PI,ZN}(s)=670.3052+\frac{2031.2278}{s}.
\end{equation}
\\Calculation for overdamped controller behavior was chosen for controller tuning using Chien Hrones Reswick. Determination of the parameters $K_P$ and $K_I$ is performed following the equations presented in \tablename~\ref{tab:param_chr}, resulting in
\begin{equation}
  K_P = 0.35\cdot\frac{0.193}{0.0026\cdot0.1}=260.6742
\end{equation}
and
\begin{equation}
  K_I = \frac{260.6742}{1.2\cdot0.1}=2172.2853.
\end{equation}
This in turn leads to the transfer function
\begin{equation}
  G_{PI,CHR}(s)=260.6742+\frac{2172.2853}{s}.
\end{equation}
\subsection{Evaluation}
The main purpose for utilization of a PI controller, in this work, is to stabilize the closed loop system behavior in preparation for an ILC implementation.
Both controllers are tested under the same operating conditions and their performance is compared.
\\Even though the controllers are tuned at $\Delta{p}=40\,mmHg$, both of them  are tested in the differential pressure operating range from $\Delta{p}=0\,mmHg$ to $\Delta{p}=100\,mmHg$ to ensure sufficient performance in all use cases.
For each differential pressure level three consecutive steps up and down throughout the operating range of flow are performed. Each reference flow is targeted for $5\,s$ and flow through the VAD is measured. A graphical representation of the reference signal curves is depicted in \figurename~\ref{fig:PI_control_ref_signals}.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/PI_control_ref_signals.pdf}
  \caption[Reference signals for PI controller performance evaluation]{Reference signals for PI controller performance evaluation. Top: differential pressure reference value. Bottom: targeted flow trajectory.}
  \label{fig:PI_control_ref_signals}
\end{figure}
\figurename~\ref{fig:pi_contr_chr_40} depicts the differential pressure and flow reference values, the measured pressure and flow value and the actuation variable in form of the reference rotational speed $v_{act}$ and rotational speed of the VAD $v_{vad}$ for the differential pressure level $\Delta{p}=40\,mmHg$ using the PI controller tuned according to Chien Hrones Reswick.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.9\textwidth]{images/chapt_5/pi_contr_chr_40.pdf}
  \caption[Test measurement for PI controller tuned according to Chien Hrones Reswick at $\Delta{p}=40\,mmHg$]{Test measurement for PI controller tuned according to Chien Hrones Reswick at $\Delta{p}=40\,mmHg$.}
  \label{fig:pi_contr_chr_40}
\end{figure}
\\The complete signal curves for the tests of the controllers are depicted in \figurename~\ref{fig:anh_6} and \figurename~\ref{fig:anh_7} in the appendix. Furthermore, the graphical representation of the test measurement at $\Delta{p}=40\,mmHg$ for the controller tuned according to Ziegler Nichols is depicted in \figurename~\ref{fig:anh_8} of the appendix.
\\The course of the control error throughout the test measurements of the controller tuned according to Ziegler Nichols and the controller tuned according to Chien Hrones Reswick are depicted in \figurename~\ref{fig:PI_error_a} and \figurename~\ref{fig:PI_error_b}, respectively.
\begin{figure}[ht]
  \centering
  \subfloat[]
  {\includegraphics[width=0.5\textwidth]{images/chapt_5/error_PI_zn.pdf}\label{fig:PI_error_a}}
  \subfloat[]
  {\includegraphics[width=0.5\textwidth]{images/chapt_5/error_PI_chr.pdf}\label{fig:PI_error_b}}
  \caption[Controll error for PI Controllers]{Controll error for PI controllers tuned according to (a) Ziegler Nichols, (b) Chien Hrones Reswick}
  \label{fig:PI_error}
\end{figure}
\\Throughout this work, for evaluation of controller performance the root mean square error (RMSE), according to \cite{RMSE}, defined as
\begin{equation}
  RMSE = \sqrt{\frac{1}{n}\sum_{i=0}^n e_i^2}
\end{equation}
is used. The RMSE for the differential pressure level of $\Delta{p}=40\,mmHg$ for Ziegler Nichols tuned controller amounts to
\begin{equation}
  RMSE_{ZN,40}=0.4013\,l/min
\end{equation}
while RMSE of the Chien Hrones Reswick tuned controller amounts to
\begin{equation}
  RMSE_{CHR,40}=0.2753\,l/min.
\end{equation}
Taking into account the full differential pressure operating range for RMSE calculation these values amount to
\begin{equation}
  RMSE_{ZN}=0.5396\,l/min
\end{equation}
and
\begin{equation}
  RMSE_{CHR}=0.3705\,l/min.
\end{equation}
Comparing these results it is evident that both controllers perform more precise in the range of $\Delta{p}=40\,mmHg$, for which tuning has been performed.
Performance of the controller tuned according to Chien Hrones Reswick surpasses the Ziegler Nichols tuned one in both ranges. RMSE values for full range CHR control even indicate a higher performance in comparison to the Ziegler Nichols tuned controller in the range of $\Delta{p}=40\,mmHg$.
\\ Due to its higher performance, for all following measurements the PI controller tuned in reference to Chien Hrones Reswick is used.
\section{Iterative Learning Control}\label{ILC_1}
As shown in \figurename~\ref{fig:pi_contr_chr_40}, the exclusive use of a PI controller for flow control leads to necessity of long measurement times to allow the flow to settle at a new reference value. However, one goal of this thesis is to enable flow control following different reference trajectories which may imply the need for faster reference tracking. By implementing an ILC approach, the necessary reduction of the settling time, by gaining information from error values of the preceding iteration, should be made possible.
\subsection{Design and Implementation}
During this work a P-type ILC is implemented and optimized.
\\The implementation is based on a parallel architecture as depicted in \figurename~\ref{fig:ILC_parallel}. This leads to the basic learning function for this ILC being represented by
\begin{equation}
  u_{j+1}(k) = u_{j}(k)+k_{p}e_{j}(k).
\end{equation}
The learning gain $k_p$ is experimentally chosen as
\begin{equation}
  k_p = 225
\end{equation}
to ensure quick error convergence.
\\As described in chapter \ref{ILC}, the basic ILC is extended to include a Q-Filter to enable more precise tuning of the ILC and increase its robustness.
This expansion results in the learning function being described by
\begin{equation}
  u_{j+1}(k) = Q(q)[u_{j}(k)+k_{p}e_{j}(k)].
\end{equation}
The Q-Filter is implemented as a $2^{nd}$-order butterworth filter, with sampling frequency $f_s=1000\,Hz$. The cut off frequency $f_c$ is set to several values in order to compare and thus optimize performance and robustness of the iterative learning control system.
\\An additional part of the implementation is the generation of a repeating reference and a trigger signal. The trigger signal indicates the beginning of each new iteration and thus initiates calculation of the new values $u_{j+1}(k)$ in the ILC block.
\figurename~\ref{fig:ref_signal_ILC3} depicts three iterations of the reference signal for this ILC.
\\The signal is created by first generating a square wave signal with the upper stage at $6\, l/min$ and the lower stage at $4\, l/min$. Thus, the signal encloses the average value of $5\, l/min$ of the cardiac output of a healthy heart. The reference values are each held for $0.5\, s$, so that a complete iteration would correspond to a frequency of $60\, beats\, per\, minute\, (bpm)$ when compared to the heart rate. To avoid abrupt transitions in the flow, which could lead to problems on the part of the pump, the reference signal was filtered with a first order Butterworth filter with cut off frequency $f_c=20\,Hz$ and sampling frequency $f_s=1000\,Hz$, resulting in radiused transitions. Afterwards, the signal is shifted by $0.25\, s$ to avoid placing the beginning of the signal at a jump point. The trigger signal is set from 0 to 1 at the beginning of each iteration for the duration of one sample.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/ILC/ref_signal_ILC3.pdf}
  \caption[Smoothed reference signal for ILC tuning.]{Three iterations of smoothed reference signal for ILC tuning.}
  \label{fig:ref_signal_ILC3}
\end{figure}
\subsection{Evaluation}
As mentioned above, various cut off frequencies for the Q-Filter of the ILC are tested with the aim of optimizing the ILC's performance and robustness.  \\The test signal for this purpose, is given by repeatedly presenting the reference signal from \figurename~\ref{fig:ref_signal_ILC3} to the system over a duration of $600\,s$. During the first $60\,s$ exclusively PI control is activated. By this, stable system performance at the beginning of ILC control can be ensured. Once the $60\,s$ are up, the trigger signal will set off indications for beginnings of new iterations. From this point, ILC and PI controller are working simultaneously. During the complete test measurement differential pressure is set to $\Delta{p}=40\,mmHg$. Measurements with this setup are performed for cut off frequencies $f_{c}=20\,Hz$, $f_{c}=25\,Hz$, $f_{c}=8\,Hz$ and $f_{c}=34\,Hz$.
\\\figurename~\ref{fig:pi_to_ilc} exemplifies a sequence of the measurement performed for the Q-Filter set to a cut off frequency of $f_c=20\,Hz$. The segment shows the transition from exclusive PI control to the parallel control structure of PI control and ILC. The upper graph depicts the measured differential pressure at the MCL. The spikes in this curve occur due to varying flow through the blood pump resulting in changing volumes inside the pressure chambers. The graph in the middle represents the rotational speed values for the acuating varibale $v_{act}$ and the actual velocity of the pump's rotor $v_{vad}$.

\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/ILC/pi_to_ilc_fc_20.pdf}
  \caption[Test measurement for ILC at cut off frequency $f_c=20\,Hz$]{Test measurement for ILC at cut off frequency $f_c=20\,Hz$.  Top: differential pressure value of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD.}
  \label{fig:pi_to_ilc}
\end{figure}
The bottom graph of \figurename~\ref{fig:pi_to_ilc} depicts the reference flow trajectory $q_{ref}$ and the measured flow $q_{vad}$ that is conveyed by the VAD. Looking at this curve, it can be seen that by solely using the PI controller (corresponding to $55\,s$ to $60\,s$ of the graph), the flow through the VAD cannot be adjusted fast enough and thus the reference trajectory cannot be followed successfully. However, from the onset of the ILC at about $60\,s$, it can be seen that the measured flow continues to adapt to the given reference flow within a few iterations.
\\While the system shows stable behavior over the complete measurement time for a cut off frequency of $f_c=20\,Hz$, in case of $f_c=34\,Hz$ the system shows oscillatory behavior. \figurename~\ref{fig:pi_to_ilc_fc_34} depicts part of the measurement for a cut off frequency set to $f_c=34\,Hz$.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/ILC/pi_to_ilc_fc_34.pdf}
  \caption[Test measurement for ILC at cut off frequency $f_c=34\,Hz$]{Test measurement for ILC at cut off frequency $f_c=34\,Hz$. Top: differential pressure value of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD.}
  \label{fig:pi_to_ilc_fc_34}
\end{figure}
\\The structure is the same as for \figurename~\ref{fig:pi_to_ilc}. However, in this case, looking at the middle graph it is evident that with each additional ILC iteration the actuation variable $v_{act}$ rises further towards its saturation values $4000\,rpm$ and $9000\,rpm$. This ultimately leads to the pump's rotor to stop, due to abrupt changes in speed and flow at approximately $98\,s$ measurement time.
\\Behavior of the system for a cut off frequency set to $f_c=25\,Hz$ ,as shown in \figurename~\ref{fig:pi_to_ilc_fc_25}, is similar to behavior with $f_c=34\,Hz$. The oscillatory system behavior again results in the pump's to stop at approximately $96\,s$.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/ILC/pi_to_ilc_fc_25.pdf}
  \caption[Test measurement for ILC at cut off frequency $f_c=25\,Hz$]{Test measurement for ILC at cut off frequency $f_c=25\,Hz$. Top: differential pressure value of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD.}
  \label{fig:pi_to_ilc_fc_25}
\end{figure}
\\The measurement with $f_c=8\,Hz$ as cut off frequency of the Q-Filter shows stable behavior over the complete measurement time, similar to the measurement performed with $f_c=20\,Hz$.
\\In order to determine which cut off frequency is most suited for the ILC implementation the RMSE values of the iterations for each of the measurements are compared to another. \figurename~\ref{fig:RMSE_compare_ILC3_fc} depicts the RMSE of each measurement as a function of the iteration for the first 39 iterations of the ILC. The figure also represents the RMSE value of the exclusive performing PI controller in form of the first iteration value:
\begin{equation}
  RMSE_{PI}=RMSE(1)\approx 0.85\,l/min
\end{equation}
It is evident that the curves for $f_c=25\,Hz$ and $f_c=35\,Hz$ show abrupt increases in RMSE for the iterations when the pump stopped. Due to this instable behavior these cut off frequencies are not suitable for ILC implementation.
\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/RMSE_compare_ILC3_fc.pdf}
  \caption[Comparison of RMSE values for different cut off frequency of ILC Q-Filter]{Comparison of RMSE values for different cut off frequency of ILC Q-Filter.}
  \label{fig:RMSE_compare_ILC3_fc}
\end{figure}
\\Comparing the RMSE values of the $39^{th}$ iteration of the other two frequencies it is obvious that performance of the ILC with Q-filter cut off frequency at $f_c=20\,Hz$ with
\begin{equation}
  RMSE_{f_c=20\,Hz}(39)=0.1984
\end{equation}
is higher than for $f_c=8\,Hz$ with
\begin{equation}
  RMSE_{f_c=8\,Hz}(39)=0.3951.
\end{equation}
Therefore, the cut off frequency of the Q-Filter in all following measurements will be set to $f_c=20\,Hz$.

As these measurements only took into account a differential pressure value of $\Delta{p}=40mmHg$ the ILC with the optimized Q-Filter cut off frequency is tested at pressure levels in in equal steps of $20\,mmHg$ between $\Delta{p}=20mmHg$ and $\Delta{p}=80\,mmHg$ to ensure stable system behavior in all operating points. For this the same measurement as before is executed.
\\A comparison of the RMSE values over all iterations of the ILC for the four differential pressure levels is depicted in \figurename~\ref{fig:RMSE_compare_operating_points}. The course of the RMSE values of all four measurements indicate stable system behavior. With values of approximately $0.3\, l/min$ the RMSE of the other operating points is only slightly higher than of the $40\,mmHg$ operating point with an RMSE of approximately $0.2\,l/min$. Therefore, the implemented ILC is suitable for all of the tested operating points.

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/RMSE_compare_operating_points.pdf}
  \caption[Comparison of RMSE values of the ILC at different differential pressure operating points]{Comparison of RMSE values of the ILC at different differential pressure operating points.}
  \label{fig:RMSE_compare_operating_points}
\end{figure}
\section{Iterative Learning Control with repeating disturbance}

The ILC implemented in the previous section was tested and optimized under idealized conditions without being influenced by any disturbances. Since in real use, the VAD is exposed to disturbances by pressure changes due to the beating of the heart this section aims to include this influence into the measurements through usage of the circulatory system simulator's functionality to simulate the heart beat including anticipated pressure changes.
%\subsection{Design and Implementation}

Initially, only repeating disturbances are taken into account as the standard P-type ILC used is only setup to compensate these.
The MCL will be used to introduce the setup to a disturbance in form of heart beats at a constant heart rate. Including the influence of the heart beat as a disturbance requires changing the trigger signal from a manually programmed one to using the start of each heart beat as the trigger of new iterations.
\subsection{Reference trajectories}
Testing of the ILC subjected to repeating disturbances is performed for several reference flow trajectories. These are generated using Matlab and are selectable during runtime via ControlDesk through the use of an indicator variable.

As a first reference, the flow is set to a constant value of $q_{ref}=5\,l/min$. By this, the controller's ability to balance out the pressure fluctuations during a heart beat is tested.
\\The second signal, which is used as a reference trajectory, is a sinusoidal signal that oscillates around a value of $4\, l/min$, has a maximum value of $5\, l/min$ and a minimum value of $3\, l/min$. One iteration of this signal is set to $1\,s$, matching a $60\,bpm$ heart rate. The signal course is depicted in \figurename~\ref{fig:ref_sine}.
% \begin{figure}[ht]
%   \centering
%   \includegraphics[width=0.95\textwidth]{images/chapt_5/ILC/ref_sine.pdf}
%   \caption[Sinusoidal reference signal]{Sinusoidal reference signal.}
%   \label{fig:ref_sine}
% \end{figure}

\begin{figure}[ht]
  \centering
  \subfloat[]
  {\includegraphics[width=0.5\textwidth]{images/chapt_5/ILC/ref_sine.pdf}\label{fig:ref_sine}}
  \subfloat[]
  {\includegraphics[width=0.5\textwidth]{images/chapt_5/ILC/ref_triang.pdf}\label{fig:ref_triang}}
  \caption[Controll error for PI Controllers]{Controll error for PI controllers tuned according to (a) Ziegler Nichols, (b) Chien Hrones Reswick}
  \label{fig:ref_signals}
\end{figure}
The third reference trajectory is given in form of a a triangular signal. As for the sinusoidal signal, the maximum value is set to $q_{ref}=5\,l/min$ and the minimum to $3\, l/min$. Again the full signal length is set to $1\,s$ to match a $60\,bpm$ heart rate. \figurename~\ref{fig:ref_triang} depicts one iterations of the reference trajectory.
\\As a last trajectory a step signal similar to the one used in chapter \ref{ILC_1} is chosen. The upper step is set to $q_{ref}=5\,l/min$ and the lower one to $q_{ref}=3\,l/min$. Both are hold for $0.5\,s$. Again the signal is filtered using a $1^{st}$ order butterworth filter with cut off frequency $f_c=20\,Hz$ and sampling frequency $f_s=1000\,Hz$. \figurename~\ref{fig:ref_square} depicts one iteration of the reference.
\begin{figure}[ht]
  \centering
  \includegraphics[width=0.95\textwidth]{images/chapt_5/ILC/ref_square.pdf}
  \caption[Reference step signal.]{Reference step signal.}
  \label{fig:ref_square}
\end{figure}
%
% \begin{figure}[ht]
%   \centering
%   \includegraphics[width=0.95\textwidth]{images/chapt_5/ILC/ref_triang.pdf}
%   \caption[Triangular reference signal]{Triangular reference signal.}
%   \label{fig:ref_triang}
% \end{figure}

\subsection{Evaluation}
\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/pi_to_ilc_dist_const_cf1.pdf}
  \caption[]{Segment of measurement for ILC with disturbance of $HR=60\,bpm$ with $cf_{Lv}=1$ for constant reference flow. Top:  pressure values of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD.}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/RMSE_dist_const_5_var_cf.pdf}
  \caption[RMSE Comparison of ILC at constant reference flow for varying left ventricular contractilities]{Comparison of RMSE values of the ILC for constant reference flow with disturbance of $HR=60\,bpm$ for varying contractility values of the left ventricle.}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/pi_to_ilc_dist_sine_cf1.pdf}
  \caption[]{Segment of measurement for ILC with disturbance of $HR=60\,bpm$ with $cf_{Lv}=1$ for sinusoidal reference flow. Top:  pressure values of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/RMSE_dist_sine_var_cf.pdf}
  \caption[RMSE Comparison of ILC at sinusoidal reference flow for varying left ventricular contractilities]{Comparison of RMSE values of the ILC for sinusoidal reference flow with disturbance of $HR=60\,bpm$ for varying contractility values of the left ventricle.}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/pi_to_ilc_dist_triang_cf1.pdf}
  \caption[]{Measurement for ILC with disturbance of $HR=60\,bpm$ with $cf_{Lv}=1$ for triangular reference flow. Top:  pressure values of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/pi_to_ilc_dist_triang_cf50.pdf}
  \caption[]{Segment of measurement for ILC with disturbance of $HR=60\,bpm$ with $cf_{Lv}=0.5$ for triangular reference flow. Top:  pressure values of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/RMSE_dist_triang_var_cf.pdf}
  \caption[RMSE Comparison of ILC at triangular reference flow for varying left ventricular contractilities]{Comparison of RMSE values of the ILC for triangular reference flow with disturbance of $HR=60\,bpm$ for varying contractility values of the left ventricle.}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/pi_to_ilc_dist_square_60_cf1.pdf}
  \caption[]{Segment of measurement for ILC with disturbance of $HR=60\,bpm$ with $cf_{Lv}=1$ for step reference flow. Top:  pressure values of the MCL. Middle: actuating variable and measured rotational speed of the VAD. Bottom: targeted flow trajectory and measured flow through the VAD}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/RMSE_dist_square_60_var_cf.pdf}
  \caption[RMSE Comparison of ILC at step reference flow for varying left ventricular contractilities]{Comparison of RMSE values of the ILC for step reference flow with disturbance of $HR=60\,bpm$ for varying contractility values of the left ventricle.}
  \label{fig:ref_triang}
\end{figure}

\begin{figure}[ht]
  \centering
  \includegraphics[width=\textwidth]{images/chapt_5/ILC/RMSE_dist_square_const_var_hr.pdf}
  \caption[RMSE Comparison of ILC at step reference flow for varying heart rates]{Comparison of RMSE values of the ILC for constant reference flow with disturbance of $HR=60\,bpm$ with $cf_{Lv}=1$ for varying heart rates.}
  \label{fig:ref_triang}
\end{figure}


\section{Iterative Learning Control with varying disturbance}

\subsection{}

\subsection{Evaluation}
